```markdown
# Инструмент анализа данных для экспериментов

## Описание
Этот инструмент помогает анализировать результаты экспериментов с различными атаками на данные. Поддерживает два режима работы:
1. Расчет средних значений метрик по папкам с экспериментами
2. Генерация сравнительных отчетов в Excel для выбранной атаки

## Требования
- Python 3.8+
- Установленные зависимости: `pandas`, `openpyxl`

Установите зависимости командой:
```bash
pip install pandas openpyxl
```

## Структура папок
```
.
├── main.py         # Главный скрипт
├── data/           # Папка с исходными данными
│   ├── baza/      # Пример папки с экспериментами
│   │   ├── results_earth_from_space.txt
│   │   └── ... другие файлы ...
│   ├── res1/      # Дополнительные папки с данными
│   └── res2/
└── results/        # Папка для результатов (создается автоматически)
```

## Инструкция по использованию

### 1. Запуск программы
```bash
python main.py
```

### 2. Выбор режима работы
```
Выберите режим работы:
1 - Расчет средних значений по папкам
2 - Генерация отчетов по атакам
Введите номер выбранного режима:
```

---

### Режим 1: Расчет средних значений
1. Скрипт автоматически обработает все папки в `data/`
2. Результаты сохранятся в папке `results/` в формате:
   ```
   average_<имя папки>.txt
   ```
3. Формат файла результатов:
   ```text
   Attack: No attack
   Average MSE: 0.707221 0.721520 0.736066
   Average PSNR: 49.461600 49.548600 49.635300
   ...
   ```

---

### Режим 2: Генерация отчетов Excel
1. После выбора режима 2 вы увидите список всех доступных атак:
   ```
   Доступные атаки:
   1. No attack
   2. Brightness increase
   3. Contrast decrease
   ...
   ```
2. Введите номер нужной атаки
3. Скрипт создаст файл в папке `results/` в формате:
   ```
   attack_report_<название атаки>.xlsx
   ```
4. Файл Excel содержит два листа:
   - **No Attack** - базовые показатели без атак
   - **<Атака>** - показатели для выбранной атаки

Пример таблицы:
| Folder | PSNR  | BER    |
|--------|-------|--------|
| baza   | 51.23 | 0.1767 |
| res1   | 50.98 | 0.1894 |

---

## Важные примечания
1. Все исходные файлы должны иметь формат `results_*.txt`
2. Названия атак автоматически определяются из содержимого файлов
3. Для работы с Excel-отчетами требуется:
   - Microsoft Excel или аналог
   - Библиотека openpyxl (устанавливается автоматически)
4. При отсутствии данных для какой-либо атаки в отчете будут прочерки

## Примеры файлов
Пример average_baza.txt:
```text
Attack: Brightness increase
Average MSE: 33.819800 33.831800 33.841600
Average PSNR: 32.836300 32.837500 32.839100
...
```

Пример Excel-отчета:
<img src="https://via.placeholder.com/600x300?text=Пример+Excel-таблицы" width="400">

## Поддержка
При возникновении проблем:
1. Проверьте структуру папок
2. Убедитесь в наличии файлов данных
3. Проверьте установленные зависимости

Для дополнительной помощи обращайтесь к разработчику инструмента.
```